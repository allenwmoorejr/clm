"use client";import {useEffect,useRef,useState} from 'react';function burst(){const colors=['#fff','#ffd166','#06d6a0','#118ab2','#ef476f'];const c=document.createElement('div');c.style.position='fixed';c.style.inset='0';c.style.pointerEvents='none';c.style.zIndex='9999';document.body.appendChild(c);for(let i=0;i<100;i++){const d=document.createElement('div');d.style.position='absolute';d.style.width='8px';d.style.height='14px';d.style.background=colors[Math.floor(Math.random()*colors.length)];d.style.top='0px';d.style.left=Math.random()*100+'vw';d.style.transform=`rotate(${Math.random()*360}deg)`;d.style.opacity='0.9';d.style.borderRadius='2px';d.animate([{transform:d.style.transform,top:'-10px',opacity:1},{transform:`translateY(${80+Math.random()*20}vh) rotate(${Math.random()*360}deg)`,opacity:0.9}],{duration:1800+Math.random()*900,easing:'cubic-bezier(.2,.7,.2,1)',fill:'forwards'});c.appendChild(d);}setTimeout(()=>c.remove(),2600);}export function LiveTakeover(){const [d,setD]=useState(null as any);const prev=useRef(false);useEffect(()=>{let m=true;const poll=()=>fetch('/api/live').then(r=>r.json()).then(x=>{if(!m)return;setD(x);if(!prev.current&&x?.live){burst();}prev.current=!!x?.live;}).catch(()=>{});poll();const id=setInterval(poll,30000);return()=>{m=false;clearInterval(id)}},[]);if(!d?.live)return null;const href=d.videoId?`https://www.youtube.com/watch?v=${d.videoId}`:'#';return(<div className='fixed top-0 left-0 right-0 z-50 bg-red-600 text-white'><div className='container py-2 flex items-center justify-between gap-4'><div className='font-medium'>We’re LIVE now — join the stream!</div><a href={href} target='_blank' rel='noreferrer' className='btn-primary'>Watch on YouTube</a></div></div>)}